<div class="search-container">
  <div class="search-header">
    <h1>ğŸ” Search Diary</h1>
    <div class="user-info">
      <span class="user-email">{{ userEmail() }}</span>
      <button (click)="logout()" class="logout-button">Logout</button>
    </div>
  </div>

  <div class="search-form-container">
    <form [formGroup]="searchForm" (ngSubmit)="onSearch()" class="search-form">
      <div class="form-row">
        <div class="form-group">
          <label for="query">Search Text</label>
          <input
            id="query"
            type="text"
            formControlName="query"
            placeholder="Search in title and body..."
            class="search-input"
          />
        </div>

        <div class="form-group">
          <label for="tags">Tags (comma-separated)</label>
          <input
            id="tags"
            type="text"
            formControlName="tags"
            placeholder="work, personal, ideas..."
            class="search-input"
          />
        </div>
      </div>

      <div class="form-actions">
        <button
          type="submit"
          [disabled]="isSearching()"
          class="search-button"
        >
          @if (isSearching()) {
          <span>Searching...</span>
          } @else {
          <span>ğŸ” Search</span>
          }
        </button>

        <button
          type="button"
          (click)="clearSearch()"
          class="clear-button"
        >
          Clear
        </button>

        <a routerLink="/diary" class="back-link">â† Back to Editor</a>
      </div>
    </form>
  </div>

  @if (hasSearched()) {
  <div class="search-results">
    <h2>
      Search Results
      <span class="result-count">({{ searchResults().length }} found)</span>
    </h2>

    @if (searchResults().length === 0) {
    <div class="no-results">
      <p>No diary entries found matching your search criteria.</p>
      <p>Try different keywords or tags.</p>
    </div>
    } @else {
    <div class="results-list">
      @for (item of searchResults(); track item.date) {
      <div class="result-item" (click)="viewEntry(item.date)">
        <div class="result-header">
          <h3 class="result-title">{{ item.title || "Untitled" }}</h3>
          <span class="result-date">{{ item.date }}</span>
        </div>

        <div class="result-body">
          {{ item.body.substring(0, 200)
          }}{{ item.body.length > 200 ? "..." : "" }}
        </div>

        @if (item.tags && item.tags.length > 0) {
        <div class="result-tags">
          @for (tag of item.tags; track tag) {
          <span class="tag">{{ tag }}</span>
          }
        </div>
        }
      </div>
      }
    </div>
    }
  </div>
  }
</div>

